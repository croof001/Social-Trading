<h4>Listing tweets</h4><hr/>
<div style="margin-bottom:20px;"><%= link_to 'Fetch tweets', tweets_path(:AUTH_TOKEN => form_authenticity_token.inspect),:class=>'btn  btn-primary',:method=>:post %></div>

<div class="well">
<%=  form_tag(tweets_path, method: :get, id: :filterrific_filter, :class =>'form-inline') do%>
<legend>Filter</legend>
    <label>Search</label>
    <%# give the search field the 'filterrific-periodically-observed' class for live updates %>
    <%= text_field_tag(
      'filterrific[search_query]',@filterrific.search_query,
      :class => 'filterrific-periodically-observed search-query '
    ) %>
    <label>User</label>
    <div class="input-prepend">
    <span class="add-on">@</span>
   <%= text_field_tag(
      'filterrific[with_author]',@filterrific.with_author,
      :class => 'filterrific-periodically-observed'
    ) %>
    </div>
 
    <label>Fetched after</label>
    <%= text_field_tag('filterrific[with_created_at_gte]',@filterrific.with_created_at_gte, :id=>'datepicker1') %>

    <label>Sort by</label>
    <%= select_tag('filterrific[sorted_by]', options_for_select(Tweet.options_for_sorted_by),:class=>'chosen-select') %>
    
    <label>Keyword</label>
    <%= collection_select 'filterrific','with_keyword_id',Keyword.where(:client=>current_client),:id,:phrase,{prompt: true},{:multiple=>:multiple, :class=>"chosen-select",'data-placeholder'=>'Choose one or more keywords'}%>
  
    <%= link_to(
      'Reset',
      reset_filterrific_tweets_path,:class=>"btn btn-inverse"
    ) %>
 
  <%# add an automated spinner to your form when the list is refreshed %>
  <%= render_filterrific_spinner %>
<% end %>
</div>

<script type="text/javascript">
    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : {allow_single_deselect:true},
      '.chosen-select-no-single' : {disable_search_threshold:10},
      '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      '.chosen-select-width'     : {width:"95%"}
    }
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }
  </script>
 <script type="text/javascript">
 	$('#datepicker1').datetimepicker({
 		onClose: function(a){$('#datepicker1').change();}
 	});
 </script>

<%= render(
  :partial => 'tweets/list',
  :locals => { :gtweets => @gtweets }
) %>